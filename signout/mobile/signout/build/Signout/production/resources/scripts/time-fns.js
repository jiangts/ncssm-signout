var SunriseSunset=function(f,a,c,e,b){this.zenith=90+50/60;this.utcFullYear=f;this.utcMonth=a;this.utcDay=c;this.latitude=e;this.longitude=b;this.rising=true;this.lngHour=this.longitude/15};SunriseSunset.prototype={sin:function(a){return Math.sin(a*Math.PI/180)},cos:function(a){return Math.cos(a*Math.PI/180)},tan:function(a){return Math.tan(a*Math.PI/180)},asin:function(a){return(180/Math.PI)*Math.asin(a)},acos:function(a){return(180/Math.PI)*Math.acos(a)},atan:function(a){return(180/Math.PI)*Math.atan(a)},getDOY:function(){var g=this.utcMonth,c=this.utcFullYear,a=this.utcDay;var f=Math.floor(275*g/9);var e=Math.floor((g+9)/12);var b=(1+Math.floor((c-4*Math.floor(c/4)+2)/3));var h=f-(e*b)+a-30;return h},approximateTime:function(){var a=this.getDOY();if(this.rising){return a+((6-this.lngHour)/24)}else{return a+((18-this.lngHour)/24)}},meanAnomaly:function(){var a=this.approximateTime();return(0.9856*a)-3.289},trueLongitude:function(){var b=this.meanAnomaly();var a=b+(1.916*this.sin(b))+(0.02*this.sin(2*b))+282.634;return a%360},rightAscension:function(){var a=this.trueLongitude();var e=this.atan(0.91764*this.tan(a));e%=360;var c=(Math.floor(a/90))*90;var b=(Math.floor(e/90))*90;e=e+(c-b);e/=15;return e},sinDec:function(){var a=this.trueLongitude(),b=0.39782*this.sin(a);return b},cosDec:function(){return this.cos(this.asin(this.sinDec()))},localMeanTime:function(){var f=(this.cos(this.zenith)-(this.sinDec()*this.sin(this.latitude)))/(this.cosDec()*this.cos(this.latitude));if(f>1){return"the sun never rises on this location (on the specified date)"}else{if(f<-1){return"the sun never sets on this location (on the specified date)"}else{var c=this.rising?360-this.acos(f):this.acos(f);c/=15;var e=this.rightAscension();var b=this.approximateTime();var a=c+e-(0.06571*b)-6.622;return a}}},hoursRange:function(a){return(a+24)%24},UTCTime:function(){var a=this.localMeanTime();var b=a-this.lngHour;return this.hoursRange(b)},sunriseUtcHours:function(){this.rising=true;return this.UTCTime()},sunsetUtcHours:function(){this.rising=false;return this.UTCTime()},sunriseLocalHours:function(a){return this.hoursRange(a+this.sunriseUtcHours())},sunsetLocalHours:function(a){return this.hoursRange(a+this.sunsetUtcHours())},isDaylight:function(c){var b=this.sunriseUtcHours(),a=this.sunsetUtcHours();if(a<b){if(c>b){return true}else{if(c<a){return true}else{return false}}}if(c>=b){return c<a}return false}};function SunriseSunsetTest(){var n={"Los Angeles":{lat:34.05,lon:-118.23333333,tests:[{year:2011,month:1,day:22,utcHours:19.6666666,isDaylight:true}]},Berlin:{lat:52.5,lon:13.366666667,tests:[{year:2011,month:1,day:25,utcHours:1.25,isDaylight:false},{year:2011,month:2,day:22,utcHours:2.5,isDaylight:false}]},Tokyo:{lat:35+40/60,lon:139+45/60,tests:[{year:2011,month:1,day:23,utcHours:1.5,isDaylight:true},{year:2011,month:1,day:23,utcHours:22.5,isDaylight:true}]},Seoul:{lat:37.55,lon:126.966666667,tests:[{year:2011,month:4,day:10,utcHours:15+30/60,isDaylight:false}]},"New Delhi":{lat:35+40/60,lon:139+45/60,tests:[]},Sydney:{lat:-(33+55/60),lon:151+17/60,tests:[{year:2011,month:5,day:1,utcHours:17+53/60,isDaylight:false}]},Santiago:{lat:-(33+26/60),lon:-(70+40/60),tests:[{year:2011,month:5,day:1,utcHours:17+54/60,isDaylight:true}]}};var g=0;var a=0;for(var h in n){var b=n[h];for(var e=0;e<b.tests.length;e++){var j=b.tests[e];var l=new SunriseSunset(j.year,j.month,j.day,b.lat,b.lon);var f=j.isDaylight;var k=l.isDaylight(j.utcHours);var c=k===f;g++;if(!c){a++}print(h,j.year,j.month,j.day,j.utcHours,"passed:",c);if(!c){print("sunriseUtcHours="+l.sunriseUtcHours()+", sunsetUtcHours="+l.sunsetUtcHours())}}}print("tests: "+g,"failed: "+a)}var today=new Date();var y=today.getFullYear();var m=today.getMonth()+1;var d=today.getDate();var durham=new SunriseSunset(y,m,d,36.0225,-78.9764);var sunrise=durham.sunriseLocalHours(-4);var sunset=durham.sunsetLocalHours(-4);var sunRiseHour=Math.floor(sunrise);var sunRiseMin=Math.floor((sunrise-Math.floor(sunrise))*60);var sunSetHour=Math.floor(sunset)-12;var sunSetMin=Math.floor((sunset-Math.floor(sunset))*60);sunRiseMin=""+sunRiseMin;sunRiseHour=""+sunRiseHour;sunSetMin=""+sunSetMin;sunSetHour=""+sunSetHour;if(sunRiseMin.length<2){sunRiseMin="0"+sunRiseMin}if(sunSetMin.length<2){sunSetMin="0"+sunSetMin}var timeAgoInWords=function(b){try{var a=Math.ceil(Number(new Date())/1000),c=Math.ceil(Number(new Date(b))/1000),g=a-c,h;if(g<60){return String(g)+" seconds ago"}else{if(g<3600){h=String(Math.ceil(g/(60)));return h+(h=="1"?" minute":" minutes")+" ago"}else{if(g<86400){h=String(Math.ceil(g/(3600)));return h+(h=="1"?" hour":" hours")+" ago"}else{if(g<60*60*24*365){h=String(Math.ceil(g/(60*60*24)));return h+(h=="1"?" day":" days")+" ago"}else{return Ext.Date.format(new Date(b),"jS M 'y")}}}}}catch(f){return""}};var timeCompareInWords=function(h,c){try{var a=Math.ceil(Number(new Date(c))/1000),b=Math.ceil(Number(new Date(h))/1000),g=a-b,i;if(Math.abs(g)<60){return String(g)+" seconds"}else{if(Math.abs(g)<3600){i=String(Math.ceil(g/(60)));return i+(i=="1"?" minute":" minutes")}else{if(Math.abs(g)<86400){i=String(Math.ceil(g/(3600)));return i+(i=="1"?" hour":" hours")}else{if(Math.abs(g)<60*60*24*365){i=String(Math.ceil(g/(60*60*24)));return i+(i=="1"?" day":" days")}else{return Ext.Date.format(new Date(h),"jS M 'y")}}}}}catch(f){return""}};