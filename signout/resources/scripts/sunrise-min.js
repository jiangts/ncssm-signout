var SunriseSunset=function(e,a,c,d,b){this.zenith=90+50/60;this.utcFullYear=e;this.utcMonth=a;this.utcDay=c;this.latitude=d;this.longitude=b;this.rising=true;this.lngHour=this.longitude/15};SunriseSunset.prototype={sin:function(a){return Math.sin(a*Math.PI/180)},cos:function(a){return Math.cos(a*Math.PI/180)},tan:function(a){return Math.tan(a*Math.PI/180)},asin:function(a){return(180/Math.PI)*Math.asin(a)},acos:function(a){return(180/Math.PI)*Math.acos(a)},atan:function(a){return(180/Math.PI)*Math.atan(a)},getDOY:function(){var f=this.utcMonth,c=this.utcFullYear,a=this.utcDay;var e=Math.floor(275*f/9);var d=Math.floor((f+9)/12);var b=(1+Math.floor((c-4*Math.floor(c/4)+2)/3));var g=e-(d*b)+a-30;return g},approximateTime:function(){var a=this.getDOY();if(this.rising){return a+((6-this.lngHour)/24)}else{return a+((18-this.lngHour)/24)}},meanAnomaly:function(){var a=this.approximateTime();return(0.9856*a)-3.289},trueLongitude:function(){var b=this.meanAnomaly();var a=b+(1.916*this.sin(b))+(0.02*this.sin(2*b))+282.634;return a%360},rightAscension:function(){var a=this.trueLongitude();var d=this.atan(0.91764*this.tan(a));d%=360;var c=(Math.floor(a/90))*90;var b=(Math.floor(d/90))*90;d=d+(c-b);d/=15;return d},sinDec:function(){var a=this.trueLongitude(),b=0.39782*this.sin(a);return b},cosDec:function(){return this.cos(this.asin(this.sinDec()))},localMeanTime:function(){var e=(this.cos(this.zenith)-(this.sinDec()*this.sin(this.latitude)))/(this.cosDec()*this.cos(this.latitude));if(e>1){return"the sun never rises on this location (on the specified date)"}else{if(e<-1){return"the sun never sets on this location (on the specified date)"}else{var c=this.rising?360-this.acos(e):this.acos(e);c/=15;var d=this.rightAscension();var b=this.approximateTime();var a=c+d-(0.06571*b)-6.622;return a}}},hoursRange:function(a){return(a+24)%24},UTCTime:function(){var a=this.localMeanTime();var b=a-this.lngHour;return this.hoursRange(b)},sunriseUtcHours:function(){this.rising=true;return this.UTCTime()},sunsetUtcHours:function(){this.rising=false;return this.UTCTime()},sunriseLocalHours:function(a){return this.hoursRange(a+this.sunriseUtcHours())},sunsetLocalHours:function(a){return this.hoursRange(a+this.sunsetUtcHours())},isDaylight:function(c){var b=this.sunriseUtcHours(),a=this.sunsetUtcHours();if(a<b){if(c>b){return true}else{if(c<a){return true}else{return false}}}if(c>=b){return c<a}return false}};function SunriseSunsetTest(){var l={"Los Angeles":{lat:34.05,lon:-118.23333333,tests:[{year:2011,month:1,day:22,utcHours:19.6666666,isDaylight:true}]},Berlin:{lat:52.5,lon:13.366666667,tests:[{year:2011,month:1,day:25,utcHours:1.25,isDaylight:false},{year:2011,month:2,day:22,utcHours:2.5,isDaylight:false}]},Tokyo:{lat:35+40/60,lon:139+45/60,tests:[{year:2011,month:1,day:23,utcHours:1.5,isDaylight:true},{year:2011,month:1,day:23,utcHours:22.5,isDaylight:true}]},Seoul:{lat:37.55,lon:126.966666667,tests:[{year:2011,month:4,day:10,utcHours:15+30/60,isDaylight:false}]},"New Delhi":{lat:35+40/60,lon:139+45/60,tests:[]},Sydney:{lat:-(33+55/60),lon:151+17/60,tests:[{year:2011,month:5,day:1,utcHours:17+53/60,isDaylight:false}]},Santiago:{lat:-(33+26/60),lon:-(70+40/60),tests:[{year:2011,month:5,day:1,utcHours:17+54/60,isDaylight:true}]}};var f=0;var a=0;for(var g in l){var b=l[g];for(var d=0;d<b.tests.length;d++){var h=b.tests[d];var k=new SunriseSunset(h.year,h.month,h.day,b.lat,b.lon);var e=h.isDaylight;var j=k.isDaylight(h.utcHours);var c=j===e;f++;if(!c){a++}print(g,h.year,h.month,h.day,h.utcHours,"passed:",c);if(!c){print("sunriseUtcHours="+k.sunriseUtcHours()+", sunsetUtcHours="+k.sunsetUtcHours())}}}print("tests: "+f,"failed: "+a)};